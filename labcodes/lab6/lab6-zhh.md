# Rerport: LAB6

计13，张宏辉，2011011237
 
## 练习0：填写已有实验
 - 已完成

## 练习1: 使用 Round Robin 调度算法（不需要编码）

 - 请理解并分析sched_calss中各个函数指针的用法，并接合Round Robin 调度算法描ucore的调度执行过程
   - sched_class中各个函数指针分析如下
     - init函数初始化进程调度队列，参数为初始队列
     - enqueue函数往进程调度队列中加入一个进程，参数为处理队列和加入进程
     - dequeue函数从进程队列中删除一个进程，参数为处理队列和删除进程
     - pick_next函数从进程调度队列中选取下一个执行的进程，参数为处理队列
     - proc_tick函数在产生时钟中断的时候对进程调度队列进行管理和更新，参数为处理队列和处理进程
    
   - Ucore中的调度执行算法如下
   	 - 将就绪进程组织成一个链表。
   	 - 每次产生一个时钟中断时，当前进程的time_slice就减一。如果当前进程的time_slice仍大于零则可继续执行，否则当前进程已经用完分配给它的所有时间片，调度算法将其need_resched标记为1，表明当前进程需要被重新调度。
   	 - 当产生时钟中断或者其他异常的时候，操作系统会判断当前进程的need_resched标志，如果为1那么调用schedule函数启用调度算法，否则不启用。
   	 - 调度算法先判断当前进程是否为就绪状态，如果是的话将其加入进程调度队列。
   	 - 调度算法从进程队列中挑选出一个进程作为下一个被执行的进程，调度完成。对于RR算法而言，会使用队列中的下一个进程执行。
   
 - 请在实验报告中简要说明如何设计实现“多级反馈队列调度算法”，给出概要设计，鼓励给出详细设计
   - 为了实现“多级反馈队列调度算法”，可以在sched_class中维护多个数据结构，不同数据结构针对不同算法。
   - 执行调度时，先判断要采用哪一种算法，然后从这种算法对应的数据结构中取出当前优先级最高的进程执行。
   - 新加入进程时，先判断要加入哪一种数据结构，然后依据该数据结构对应的算法进行插入。
   - 对于需要变更数据结构的进程，在条件被触发时，从原来的数据结构中取出该进程，然后插入到要加入的数据结构中。
 
## 练习2: 实现 Stride Scheduling 调度算法（需要编码）

 - 简要说明你的设计实现过程
   - 用default_sched_stride_c覆盖default_sched.c，在此基础上按照注释进行修改。
   - 将BIG_STRIDE设置为一个很大的整数，这里定义为0xfffffff。
   - 在stride_init中，对run_list链表、lab6_run_pool和proc_num进行初始化。
   - 在enqueue函数中，调用skew_heap_insert将当前进程加入就绪进程队列中，将当前进程的可用时间片值设置为max_time_slice，并将当前进程的调度队列rq进行设置，增加计数器proc_num的值。
   - 在dequeue函数中，调用skew_heap_remove函数删除就绪进程队列中的一个进程，并且计数器proc_num减一。
   - 在pick_next函数中，先判断调度队列是否为空，如果为空则直接返回空指针。否则取出队列首部的进程，修改该进程的stride标志，表示该进程将会执行的pass的值。而pass的值根据BIG_STRIDE除以优先级得出。
   - 在proc_tick函数中，将当前进程的time_slice减一。如果time_slice减至零那么说明当前进程需要被调度，设置相关标志位。

